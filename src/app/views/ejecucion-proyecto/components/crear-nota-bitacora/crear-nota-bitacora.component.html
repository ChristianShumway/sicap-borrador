<div fxLayout="row wrap"  *ngIf="!(obraObs$ | async) as obra">
  <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
    <div class="wrap-spiner">
      <mat-spinner></mat-spinner>
    </div>
  </div>
</div>

<div fxLayout="row wrap" *ngIf="(obraObs$ | async) as obra">
  <form [formGroup]="notaBitacoraForm" (submit)="reportarAvance()">
    <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" class="container-obra">
      <div class="info-obra">
        <h1>{{obra.noContrato}}</h1>
        <p>{{obra.nombreObra}}</p>
      </div>
  
      <div class="info-bitacora">
        <div class="pb-1">
          <mat-form-field class="full-width">
            <textarea matInput placeholder="Nota" formControlName="notaBitacora"></textarea>
          </mat-form-field>
        </div>
        <div class="pb-1">
          <mat-form-field class="full-width">
            <input  matInput placeholder="Latitud" name="latitud" formControlName="latitud" readonly>
          </mat-form-field>
        </div>
        <div class="pb-1">
          <mat-form-field class="full-width">
            <input  matInput placeholder="Longitud" name="longitud" formControlName="longitud" readonly>
          </mat-form-field>
        </div>
      </div>
  
      <h5>Dirección: {{address}}</h5>
  
      <!-- <div class="form-group">
        <label>Enter address</label>
        <input type="text" class="form-control" (keydown.enter)="$event.preventDefault()" placeholder="Search Nearest Location" autocorrect="off"
          autocapitalize="off" spellcheck="off" type="text" #search>
      </div> -->
  
      <agm-map 
      [latitude]="latitude" 
      [longitude]="longitude" 
      [zoom]="zoom" 
      [scrollwheel]="null"
      [gestureHandling]="'cooperative'">
        <agm-marker 
        [latitude]="latitude" 
        [longitude]="longitude" 
        [markerDraggable]="true" 
        (dragEnd)="markerDragEnd($event)">
        </agm-marker>
      </agm-map>
  
      <div class="wrap-button" *ngIf = "catalogo.length">
        <button mat-raised-button color="primary"  [disabled]="notaBitacoraForm.invalid" type="submit">Validar</button>
      </div>
  
    </div>
  </form>


  <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" class="container-catalogo" *ngIf = "catalogo.length">
    <div class="mat-box-shadow margin-333">
      <ngx-datatable 
      class="material fullscreen bg-white"
      [rows]="catalogo"
      [columnMode]="'force'"
      [headerHeight]="50"
      [footerHeight]="50"
      [scrollbarH]="true"
      [rowHeight]="'auto'"
      [limit]="20"
      [scrollbarH]="true"
      [rowHeight]="50">
        
        <ngx-datatable-column name="No." [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
              <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
                {{ row?.noConcepto }}
              </p>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Descripción" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
              {{row?.descripcion}}
            </p>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Unidad" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
              {{row?.unidad}}
            </p>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Cantidad" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
              {{row?.cantidad}}
            </p>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Precio Unitario" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
              {{row?.precioUnitario | currency}}
            </p>
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column name="Importe" [flexGrow]="1">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <p [ngStyle]="{'color':row?.tipo === 2 ? 'green' : 'black' }">
              {{row?.importe | currency}}
            </p>
          </ng-template>
        </ngx-datatable-column>

      </ngx-datatable>
    </div>
  </div>
</div>
