<!-- FILTRO -->
<!-- <mat-form-field class="margin-333" style="width: 98.8%; margin-top: 20px !important;">
  <input matInput (keyup)="applyFilterRequest($event.target.value)" placeholder="Filtro Solicitud">
</mat-form-field> -->
<!-- END FILTRO -->

<!-- <ng-container>
  <p class="legend-color">
    <span class="bar-color"> </span>
    Si al pasar el cursor sobre alguna solicitud y el fondo es de este color, significa que tiene ordenes de trabajo asignadas
    y para poder ver las ordenes de trabajo da click sobre la solicitud.
  </p>
  <div class="options-color">
    <b>Indicador de colores:</b>
    <div class="grid-colors">
      <p class="legend-color">
        <span class="circle-color gray"> </span>
        Proceso Inactivo
      </p>
      <p class="legend-color">
        <span class="circle-color green"> </span>
        Proceso Activo
      </p>
      <p class="legend-color">
        <span class="circle-color yellow"> </span>
        Proceso Finalizado
      </p>
      <p class="legend-color">
        <span class="circle-color red"> </span>
        Proceso Cancelado
      </p>
    </div>
  </div>
</ng-container> -->

<mat-accordion>
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>
        Filtros
      </mat-panel-title>
    </mat-expansion-panel-header>  
    <ng-container>
      <div class="pb-1">
        <mat-form-field class="full-width">
          <mat-label>Empresa</mat-label>
          <mat-select [(ngModel)]="empresa" (selectionChange)="getObrasByCompanie($event.value)">
            <mat-option value="0">Todas las empresas</mat-option>
            <mat-option *ngFor="let company of empresas" [value]="company">
              {{company.descripcion}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="pb-1">
        <mat-form-field class="full-width">
          <mat-label>Obra</mat-label>
          <mat-select [(ngModel)]="obra">
            <mat-option value=""></mat-option>
            <mat-option *ngFor="let obra of obras" [value]="obra">
              {{obra.noContrato}} - {{obra.nombreObra}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="pb-1">
        <mat-form-field class="full-width">
          <mat-label>Estatus</mat-label>
          <mat-select [(ngModel)]="estatus">
            <mat-option value = -1></mat-option>
            <mat-option value = 0>Cerradas</mat-option>
            <mat-option value = 1>Abiertas</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="wrap-button">
        <button mat-raised-button color="primary" (click)="getResources(whoSolicitud)">Buscar</button>
      </div>
    </ng-container>
  </mat-expansion-panel>
</mat-accordion>


<div class="accordions">
  <mat-accordion>
    <mat-expansion-panel (opened)="getResources(1)" [(expanded)]="panelOpenState">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Recursos
        </mat-panel-title>
        <mat-panel-description>
          <!-- SOLICITUDES -->
        </mat-panel-description>
      </mat-expansion-panel-header>
  
      <div class="container-table">
        <table #innerTableRequest mat-table #outerSort="matSort" [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8 mb"
          matSort>
          <ng-container matColumnDef="verSolicitud">
            <th mat-header-cell *matHeaderCellDef> Ver Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button (click)="openDialogRequest(element.idSolicitud, element.idTipo)" mat-icon-button color="primary"
                  matTooltip="Ver Solicitud" matTooltipPosition="left">
                  <mat-icon>visibility</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="editarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Editar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button [routerLink]="['/solicitudes-suministros/modificar-solicitud-recursos', element.idSolicitud]" mat-icon-button *ngIf="element.editarSolicitud && element.idTipo === 1"
                  color="primary" matTooltip="Modificar Solicitud" matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button *ngIf="!element.editarSolicitud && element.colorEditarSolitud ===  'gray' " color="accent" matTooltip="Proceso Inactivo"
                  matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="fecha">
            <th mat-header-cell *matHeaderCellDef> Fecha </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.fechaSolicito | date}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="folio">
            <th mat-header-cell *matHeaderCellDef> Folio </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.folio}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="empresa">
            <th mat-header-cell *matHeaderCellDef> Empresa </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.empresa}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="contrato">
            <th mat-header-cell *matHeaderCellDef> Contrato </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.noContrato}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="solicitante">
            <th mat-header-cell *matHeaderCellDef> Solicitante </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.usuarioSolicito}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="cancelarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Cancelar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button (click)="openDialoAlertDelete(element.idSolicitud, element.idTipo)" mat-icon-button *ngIf="element.eliminarSolicitud"
                  color="primary" matTooltip="Cancelar Solicitud" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
                <button mat-icon-button *ngIf="element.colorEliminarSolitud ===  'gray'" color="accent" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="abrirCerrar">
            <th mat-header-cell *matHeaderCellDef> Abrir / Cerrar </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center" style="z-index: 9999999;">
                <button *ngIf="element.estatus === 1" (click)="abrirCerrarSolicitud(element, 0)" mat-icon-button color="primary" matTooltip="Cerrar Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock_open</mat-icon>
                </button>
                <button *ngIf="element.estatus === 0" (click)="abrirCerrarSolicitud(element, 1)" mat-icon-button color="accent" matTooltip="Abrir Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <!-- Expanded Content Column  -->
          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
              <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                  <!-- <mat-form-field>
                    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filtro Orden de Trabajo">
                  </mat-form-field> -->
  
                  <table #innerTables mat-table #innerSort="matSort" class="orders-table" [dataSource]="dataWorkOrders" matSort>
                    <ng-container matColumnDef="verOrden">
                      <th mat-header-cell *matHeaderCellDef> Ver Orden de Trabajo </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'verOrden')" mat-icon-button
                            color="primary" matTooltip="Ver Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>visibility</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="fecha">
                      <th mat-header-cell *matHeaderCellDef> Fecha </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{ element.fechaOrdenTrabajo | date }} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="folio">
                      <th mat-header-cell *matHeaderCellDef> Folio </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> OT {{element.folio}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="elaboro">
                      <th mat-header-cell *matHeaderCellDef> Elaboro </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.usuarioOrdenTrabajo}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="autorizarOrden">
                      <th mat-header-cell *matHeaderCellDef> Autorizar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'autorizar')" mat-icon-button *ngIf="element.colorAutorizar === 'green'"
                            color="primary" matTooltip="Autorizar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorAutorizar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="cancelarOrden">
                      <th mat-header-cell *matHeaderCellDef> Cancelar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogDeleteOrden(element)" mat-icon-button *ngIf="element.colorEliminarOrdenTrabajo === 'green'"
                            color="primary" matTooltip="Cancelar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEliminarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo"
                            matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="estatus">
                      <th mat-header-cell *matHeaderCellDef> Estatus </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.estatus}} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="editarOrden">
                      <th mat-header-cell *matHeaderCellDef> Editar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button [routerLink]="['/solicitudes-suministros/modificar-orden-trabajo-recursos', element.idOrdenTrabajo]" mat-icon-button
                            *ngIf="element.colorEditarOrdenTrabajo === 'green'" color="primary" matTooltip="Modificar Orden de Trabajo"
                            matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEditarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <!-- <ng-container matColumnDef="exportarOrden">
                      <th mat-header-cell *matHeaderCellDef> Exportar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button mat-icon-button (click)="descargarOrdenTrabajo(element.idOrdenTrabajo, element.idTipo)" *ngIf="element.colorExportanOrden === 'green'"
                            color="primary" matTooltip="Descargar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>cloud_download</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorExportanOrden === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>cloud_download</mat-icon>
                          </button>
                          <button mat-icon-button color="warn" *ngIf="element.colorExportanOrden === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                            <mat-icon>cloud_download</mat-icon>
                          </button>
                          <button mat-icon-button *ngIf="element.colorExportanOrden ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                            matTooltipPosition="left">
                            <mat-icon>cloud_download</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container> -->
                    <!-- <ng-container matColumnDef="verificarOrden">
                      <th mat-header-cell *matHeaderCellDef> Verificar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogSupply(element.idOrdenTrabajo, element.idTipo, element.idSolicitud)" mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus !== 'Completa'"
                            color="primary" matTooltip="Verificar Suministro" matTooltipPosition="left">
                            <mat-icon>{{element.icono}}</mat-icon>
                          </button>
                          <button mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus === 'Completa'" color="primary" matTooltip="Suministrado"
                            matTooltipPosition="left">
                            <mat-icon>{{element.icono}}</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorSuministrar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>{{element.icono}}</mat-icon>
                          </button>
                          <button mat-icon-button color="warn" *ngIf="element.colorSuministrar === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                            <mat-icon>{{element.icono}}</mat-icon>
                          </button>
                          <button mat-icon-button *ngIf="element.colorSuministrar ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                            matTooltipPosition="left">
                            <mat-icon>{{element.icono}}</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container> -->
  
                    <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: innerDisplayedColumns;"></tr>
                  </table>
  
                  <div class="wrap-but" *ngIf="element.estatus !== 0">
                    <button [routerLink]="['/solicitudes-suministros/orden-pago-recursos', element.idSolicitud]" mat-mini-fab color="primary"
                      matTooltip="Crear orden de Trabajo" matTooltipPosition="left">
                      <mat-icon>add</mat-icon>
                    </button>
                  </div>
  
                </div>
              </div>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
          <tr  mat-row *matRowDef="let element; columns: columnsToDisplay;" [class.example-element-row]="element" [class.example-expanded-row]="expandedElement === element"
            (click)="toggleRow(element)">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
        </table>
        <mat-paginator #paginatorRec [pageSizeOptions]="[10, 20, 30, 40, 50, 60]" showFirstLastButtons></mat-paginator>
      </div>
  
      <div fxLayout="row wrap" *ngIf="noSolicitud">
        <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" style="text-align:center">
          <h1>No hay solicitudes realizadas hasta el momento</h1>
        </div>
      </div>
  
      <div fxLayout="row wrap" *ngIf="!solicitudes.length && !noSolicitud">
        <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
          <div class="wrap-spiner">
            <mat-spinner [diameter]="40"></mat-spinner>
          </div>
        </div>
      </div>
  
    </mat-expansion-panel>
  
    <mat-expansion-panel (opened)="getResources(2)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Materiales / Herramientas
        </mat-panel-title>
        <mat-panel-description>
          <!-- SOLICITUDES -->
        </mat-panel-description>
      </mat-expansion-panel-header>
  
      <div class="container-table">
        <table #innerTableRequest mat-table #outerSort="matSort" [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8 mb"
          matSort>
          <ng-container matColumnDef="verSolicitud">
            <th mat-header-cell *matHeaderCellDef> Ver Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button  (click)="openDialogRequest(element.idSolicitud, element.idTipo)" mat-icon-button color="primary"
                  matTooltip="Ver Solicitud" matTooltipPosition="left">
                  <mat-icon>visibility</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="editarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Editar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button [routerLink]="['/solicitudes-suministros/modificar-solicitud-materiales', element.idSolicitud]" mat-icon-button *ngIf="element.editarSolicitud"
                  color="primary" matTooltip="Modificar Solicitud" matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button *ngIf="!element.editarSolicitud && element.colorEditarSolitud ===  'gray' " color="accent" matTooltip="Proceso Inactivo"
                  matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="fecha">
            <th mat-header-cell *matHeaderCellDef> Fecha </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.fechaSolicito | date}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="folio">
            <th mat-header-cell *matHeaderCellDef> Folio </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.folio}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="empresa">
            <th mat-header-cell *matHeaderCellDef> Empresa </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.empresa}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="contrato">
            <th mat-header-cell *matHeaderCellDef> Contrato </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.noContrato}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="solicitante">
            <th mat-header-cell *matHeaderCellDef> Solicitante </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.usuarioSolicito}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="cancelarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Cancelar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button (click)="openDialoAlertDelete(element.idSolicitud, element.idTipo)" mat-icon-button *ngIf="element.eliminarSolicitud"
                  color="primary" matTooltip="Cancelar Solicitud" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
                <button mat-icon-button *ngIf="element.colorEliminarSolitud ===  'gray'" color="accent" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="abrirCerrar">
            <th mat-header-cell *matHeaderCellDef> Abrir / Cerrar </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center" style="z-index: 9999999;">
                <button *ngIf="element.estatus === 1" (click)="abrirCerrarSolicitud(element, 0)" mat-icon-button color="primary" matTooltip="Cerrar Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock_open</mat-icon>
                </button>
                <button *ngIf="element.estatus === 0" (click)="abrirCerrarSolicitud(element, 1)" mat-icon-button color="accent" matTooltip="Abrir Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <!-- Expanded Content Column  -->
          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
              <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                  <!-- <mat-form-field>
                      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filtro Orden de Trabajo">
                    </mat-form-field> -->
  
                  <table #innerTables mat-table #innerSort="matSort" class="orders-table" [dataSource]="dataWorkOrders" matSort>
                  
                    <ng-container matColumnDef="verOrden">
                      <th mat-header-cell *matHeaderCellDef> Ver Orden de Trabajo </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'verOrden')" mat-icon-button
                            color="primary" matTooltip="Ver Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>visibility</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="fecha">
                      <th mat-header-cell *matHeaderCellDef> Fecha </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{ element.fechaOrdenTrabajo | date }} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="folio">
                      <th mat-header-cell *matHeaderCellDef> Folio </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> OT {{element.folio}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="elaboro">
                      <th mat-header-cell *matHeaderCellDef> Elaboro </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.usuarioOrdenTrabajo}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="autorizarOrden">
                      <th mat-header-cell *matHeaderCellDef> Autorizar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'autorizar')" mat-icon-button *ngIf="element.colorAutorizar === 'green'"
                            color="primary" matTooltip="Autorizar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorAutorizar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="cancelarOrden">
                      <th mat-header-cell *matHeaderCellDef> Cancelar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogDeleteOrden(element)" mat-icon-button *ngIf="element.colorEliminarOrdenTrabajo === 'green'"
                            color="primary" matTooltip="Cancelar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEliminarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo"
                            matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="estatus">
                      <th mat-header-cell *matHeaderCellDef> Estatus </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.estatus}} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="editarOrden">
                      <th mat-header-cell *matHeaderCellDef> Editar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button [routerLink]="['/solicitudes-suministros/modificar-orden-trabajo-materiales', element.idOrdenTrabajo]" mat-icon-button
                            *ngIf="element.colorEditarOrdenTrabajo === 'green'" color="primary" matTooltip="Modificar Orden de Trabajo"
                            matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEditarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <!-- <ng-container matColumnDef="exportarOrden">
                        <th mat-header-cell *matHeaderCellDef> Exportar </th>
                        <td mat-cell *matCellDef="let element">
                          <span class="col-center">
                            <button mat-icon-button (click)="descargarOrdenTrabajo(element.idOrdenTrabajo, element.idTipo)" *ngIf="element.colorExportanOrden === 'green'"
                              color="primary" matTooltip="Descargar Orden de Trabajo" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button color="accent" *ngIf="element.colorExportanOrden === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button color="warn" *ngIf="element.colorExportanOrden === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorExportanOrden ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                              matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                          </span>
                        </td>
                      </ng-container> -->
                    <!-- <ng-container matColumnDef="verificarOrden">
                        <th mat-header-cell *matHeaderCellDef> Verificar </th>
                        <td mat-cell *matCellDef="let element">
                          <span class="col-center">
                            <button (click)="openDialogSupply(element.idOrdenTrabajo, element.idTipo, element.idSolicitud)" mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus !== 'Completa'"
                              color="primary" matTooltip="Verificar Suministro" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus === 'Completa'" color="primary" matTooltip="Suministrado"
                              matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button color="accent" *ngIf="element.colorSuministrar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button color="warn" *ngIf="element.colorSuministrar === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorSuministrar ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                              matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                          </span>
                        </td>
                      </ng-container> -->
  
                    <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: innerDisplayedColumns;"></tr>
                  </table>
  
                  <div class="wrap-but" *ngIf="element.estatus !== 0">
                    <button [routerLink]="['/solicitudes-suministros/orden-pago-materiales', element.idSolicitud]" mat-mini-fab color="primary"
                      matTooltip="Crear orden de Trabajo" matTooltipPosition="left">
                      <mat-icon>add</mat-icon>
                    </button>
                  </div>
  
                </div>
              </div>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
          <tr  mat-row *matRowDef="let element; columns: columnsToDisplay;" [class.example-element-row]="element" [class.example-expanded-row]="expandedElement === element"
            (click)="toggleRow(element)">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
        </table>
        <mat-paginator #paginatorMat [pageSizeOptions]="[10, 20, 30, 40, 50, 60]" showFirstLastButtons></mat-paginator>
      </div>
  
      <div fxLayout="row wrap" *ngIf="noSolicitud">
        <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" style="text-align: center">
          <h1>No hay solicitudes realizadas hasta el momento</h1>
        </div>
      </div>
  
      <div fxLayout="row wrap" *ngIf="!solicitudes.length && !noSolicitud">
        <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
          <div class="wrap-spiner">
            <mat-spinner [diameter]="40"></mat-spinner>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  
    <mat-expansion-panel (opened)="getResources(3)">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Maquinaria / Equipo
        </mat-panel-title>
        <mat-panel-description>
          <!-- SOLICITUDES -->
        </mat-panel-description>
      </mat-expansion-panel-header>
  
      <div class="container-table">
        <table #innerTableRequest mat-table #outerSort="matSort" [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8 mb"
          matSort>
          <ng-container matColumnDef="verSolicitud">
            <th mat-header-cell *matHeaderCellDef> Ver Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button (click)="openDialogRequest(element.idSolicitud, element.idTipo)" mat-icon-button color="primary"
                  matTooltip="Ver Solicitud" matTooltipPosition="left">
                  <mat-icon>visibility</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="editarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Editar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button [routerLink]="['/solicitudes-suministros/modificar-solicitud-vehiculos', element.idSolicitud]" mat-icon-button *ngIf="element.editarSolicitud"
                  color="primary" matTooltip="Modificar Solicitud" matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button *ngIf="!element.editarSolicitud && element.colorEditarSolitud ===  'gray' " color="accent" matTooltip="Proceso Inactivo"
                  matTooltipPosition="left">
                  <mat-icon>edit</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="fecha">
            <th mat-header-cell *matHeaderCellDef> Fecha </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.fechaSolicito | date}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="folio">
            <th mat-header-cell *matHeaderCellDef> Folio </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.folio}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="empresa">
            <th mat-header-cell *matHeaderCellDef> Empresa </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.empresa}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="contrato">
            <th mat-header-cell *matHeaderCellDef> Contrato </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.noContrato}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="solicitante">
            <th mat-header-cell *matHeaderCellDef> Solicitante </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center"> {{element.usuarioSolicito}} </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="cancelarSolicitud">
            <th mat-header-cell *matHeaderCellDef> Cancelar Solicitud </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center">
                <button (click)="openDialoAlertDelete(element.idSolicitud, element.idTipo)" mat-icon-button *ngIf="element.eliminarSolicitud"
                  color="primary" matTooltip="Cancelar Solicitud" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
                <button mat-icon-button *ngIf="element.colorEliminarSolitud ===  'gray'" color="accent" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                  <mat-icon>block</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="abrirCerrar">
            <th mat-header-cell *matHeaderCellDef> Abrir / Cerrar </th>
            <td mat-cell *matCellDef="let element">
              <span class="col-center" style="z-index: 9999999;">
                <button *ngIf="element.estatus === 1" (click)="abrirCerrarSolicitud(element, 0)" mat-icon-button color="primary" matTooltip="Cerrar Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock_open</mat-icon>
                </button>
                <button *ngIf="element.estatus === 0" (click)="abrirCerrarSolicitud(element, 1)" mat-icon-button color="accent" matTooltip="Abrir Solicitud"
                  matTooltipPosition="left">
                  <mat-icon>lock</mat-icon>
                </button>
              </span>
            </td>
          </ng-container>  
  
          <!-- Expanded Content Column  -->
          <ng-container matColumnDef="expandedDetail">
            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
              <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                  <!-- <mat-form-field>
                      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filtro Orden de Trabajo">
                    </mat-form-field> -->
  
                  <table #innerTables mat-table #innerSort="matSort" class="orders-table" [dataSource]="dataWorkOrders" matSort>
                    <ng-container matColumnDef="verOrden">
                      <th mat-header-cell *matHeaderCellDef> Ver Orden de Trabajo </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'verOrden')" mat-icon-button
                            color="primary" matTooltip="Ver Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>visibility</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="fecha">
                      <th mat-header-cell *matHeaderCellDef> Fecha </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{ element.fechaOrdenTrabajo | date }} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="folio">
                      <th mat-header-cell *matHeaderCellDef> Folio </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> OT {{element.folio}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="elaboro">
                      <th mat-header-cell *matHeaderCellDef> Elaboro </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.usuarioOrdenTrabajo}}</span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="autorizarOrden">
                      <th mat-header-cell *matHeaderCellDef> Autorizar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogAuthorize(element.idOrdenTrabajo, element.idTipo, element.idSolicitud, 'autorizar')" mat-icon-button *ngIf="element.colorAutorizar === 'green'"
                            color="primary" matTooltip="Autorizar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorAutorizar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>spellcheck</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="cancelarOrden">
                      <th mat-header-cell *matHeaderCellDef> Cancelar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button (click)="openDialogDeleteOrden(element)" mat-icon-button *ngIf="element.colorEliminarOrdenTrabajo === 'green'"
                            color="primary" matTooltip="Cancelar Orden de Trabajo" matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEliminarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo"
                            matTooltipPosition="left">
                            <mat-icon>block</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="estatus">
                      <th mat-header-cell *matHeaderCellDef> Estatus </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center"> {{element.estatus}} </span>
                      </td>
                    </ng-container>
  
                    <ng-container matColumnDef="editarOrden">
                      <th mat-header-cell *matHeaderCellDef> Editar </th>
                      <td mat-cell *matCellDef="let element">
                        <span class="col-center">
                          <button [routerLink]="['/solicitudes-suministros/modificar-orden-trabajo-vehiculos', element.idOrdenTrabajo]" mat-icon-button
                            *ngIf="element.colorEditarOrdenTrabajo === 'green'" color="primary" matTooltip="Modificar Orden de Trabajo"
                            matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="element.colorEditarOrdenTrabajo === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                            <mat-icon>edit</mat-icon>
                          </button>
                        </span>
                      </td>
                    </ng-container>
  
                    <!-- <ng-container matColumnDef="exportarOrden">
                        <th mat-header-cell *matHeaderCellDef> Exportar </th>
                        <td mat-cell *matCellDef="let element">
                          <span class="col-center">
                            <button mat-icon-button (click)="descargarOrdenTrabajo(element.idOrdenTrabajo, element.idTipo)" *ngIf="element.colorExportanOrden === 'green'"
                              color="primary" matTooltip="Descargar Orden de Trabajo" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button color="accent" *ngIf="element.colorExportanOrden === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button color="warn" *ngIf="element.colorExportanOrden === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorExportanOrden ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                              matTooltipPosition="left">
                              <mat-icon>cloud_download</mat-icon>
                            </button>
                          </span>
                        </td>
                      </ng-container> -->
                    <!-- <ng-container matColumnDef="verificarOrden">
                        <th mat-header-cell *matHeaderCellDef> Verificar </th>
                        <td mat-cell *matCellDef="let element">
                          <span class="col-center">
                            <button (click)="openDialogSupply(element.idOrdenTrabajo, element.idTipo, element.idSolicitud)" mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus !== 'Completa'"
                              color="primary" matTooltip="Verificar Suministro" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorSuministrar === 'green' && element.estatus === 'Completa'" color="primary" matTooltip="Suministrado"
                              matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button color="accent" *ngIf="element.colorSuministrar === 'gray'" matTooltip="Proceso Inactivo" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button color="warn" *ngIf="element.colorSuministrar === 'yellow'" matTooltip="Proceso Finalizado" matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                            <button mat-icon-button *ngIf="element.colorSuministrar ===  'red'" [color]="'cancel'" matTooltip="Orden de Trabajo Cancelada"
                              matTooltipPosition="left">
                              <mat-icon>{{element.icono}}</mat-icon>
                            </button>
                          </span>
                        </td>
                      </ng-container> -->
  
                    <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: innerDisplayedColumns;"></tr>
                  </table>
  
                  <div class="wrap-but">
                    <button [routerLink]="['/solicitudes-suministros/orden-pago-vehiculos', element.idSolicitud]" mat-mini-fab color="primary"
                      matTooltip="Crear orden de Trabajo" matTooltipPosition="left">
                      <mat-icon>add</mat-icon>
                    </button>
                  </div>
  
                </div>
              </div>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
          <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" [class.example-element-row]="element" [class.example-expanded-row]="expandedElement === element"
            (click)="toggleRow(element)">
          </tr>
          <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
        </table>
        <mat-paginator #paginatorMaq [pageSizeOptions]="[10, 20, 30, 40, 50, 60]" showFirstLastButtons></mat-paginator>
      </div>
  
          <div fxLayout="row wrap" *ngIf="noSolicitud">
            <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" style="text-align:center">
              <h1>No hay solicitudes realizadas hasta el momento</h1>
            </div>
          </div>
  
      <div fxLayout="row wrap" *ngIf="!solicitudes.length && noSolicitud">
        <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
          <div class="wrap-spiner">
            <mat-spinner [diameter]="40"></mat-spinner>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  
  </mat-accordion>
</div>
