<div fxLayout="row wrap"  *ngIf="!(obraObs$ | async) as obra">
  <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
    <mat-card class="profile-sidebar mb-1 pb-0">
      <div class="wrap-spiner">
        <mat-spinner></mat-spinner>
      </div>
    </mat-card>
  </div>
</div>

<div fxLayout="row wrap" *ngIf="(obraObs$ | async) as obra">
  <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100">
    <mat-card class="profile-sidebar mb-1 pb-0 wrap-data-obra">
      <div class="col-left">
        <div class="propic text-center">
          <img src="http://{{host}}/{{urlImg}}/files/{{obra.empresa.imagen}}" [alt]="obra.nombre">
        </div>
        <div class="profile-title text-center mb-1">
          <div class="main-title">{{obra.noContrato}}
          </div>
          <div class="subtitle mb-05">{{obra.nombreObra}}</div>
          <div class="subtitle mb-05">Días Faltantes: {{obra.fechaFin | diasFaltantes}} días</div>
        </div>
        <div class="profile-actions mb-1" fxLayoutAlign="center center">
          <span fxFlex="8px"></span>
        </div>
      </div>
      <div class="col-right wrap-info-obra">
        <!-- <h2>Información de la obra</h2> -->
        <mat-list>
          <!-- {{obra.plazoEjecucion | json}} -->
          <mat-list-item>
            <mat-icon class="mr-1">date_range</mat-icon><span class="span-info">Fecha Inicio:</span> {{obra.fechaInicio | date}}</mat-list-item>
          <mat-list-item>
            <mat-icon class="mr-1">date_range</mat-icon><span class="span-info">Fecha Fin:</span> {{obra.fechaFin | date}}</mat-list-item>
          <mat-list-item>
            <mat-icon class="mr-1">map</mat-icon><span class="span-info">Lugar de Trabajo:</span> {{obra.lugarTrabajo}}</mat-list-item>
          <mat-list-item>
            <mat-icon class="mr-1">timer</mat-icon><span class="span-info">Plazo Ejecución:</span> {{obra.plazoEjecucion}} días</mat-list-item>
          <mat-list-item class="list-supervisores">
            <mat-icon class="mr-1">person</mat-icon>
            <span class="span-info">Supervisor:</span> 
            <div *ngIf="obra.supervisor.length > 1" class="multiple-supervisor">
              <ul class="text">
                <li *ngFor="let supervisor of obra.supervisor"> {{supervisor.nombre}} {{supervisor.apellidoPaterno}} {{supervisor.apellidoMaterno}} </li>
              </ul> 
            </div>
            <div *ngIf="obra.supervisor.length === 1">
              <span *ngFor="let supervisor of obra.supervisor"> {{supervisor.nombre}} {{supervisor.apellidoPaterno}} {{supervisor.apellidoMaterno}} </span>
            </div>
          </mat-list-item>
          <mat-list-item>
            <mat-icon class="mr-1">business_center</mat-icon><span class="span-info">Cliente:</span> {{obra.cliente.nombre}}</mat-list-item>
          <mat-list-item class="list-supervisores">
            <mat-icon class="mr-1">emoji_people</mat-icon>
            <span class="span-info">Destajista:</span> 
            <div *ngIf="obra.destajista.length > 1">
              <ul class="text">
                <li *ngFor="let destajista of obra.destajista"> {{destajista.nombre}}</li>
              </ul> 
            </div>
            <div *ngIf="obra.destajista.length === 1">
              <span *ngFor="let destajista of obra.destajista"> {{destajista.nombre}} </span>
            </div>
          </mat-list-item>
          <mat-list-item>
            <mat-icon class="mr-1">attach_money</mat-icon><span class="span-info">Monto Total:</span> {{obra.presupuestoTotal | transformCurrency}}</mat-list-item>
        </mat-list>
      </div>
    </mat-card>
  </div>

  <div xFlex="100" fxFlex.gt-sm="100" fxFlex.gt-md="100" class="submenu">
    <mat-card>
      <div class="profile-nav">
        <mat-nav-list>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="ficha-planeacion/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">folder</mat-icon>
            Ficha de Planeación
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="catalogo-conceptos/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">layers</mat-icon>
            Catálogo de Conceptos
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="catalogo-mano-obra/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">layers</mat-icon>
            Catálogo Mano de Obra
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="catalogo-subcontrato/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">layers</mat-icon>
            Catálogo de Subcontratos
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="lista-materiales/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">local_mall</mat-icon>
            Lista de Materiales
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="lista-personal/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">people</mat-icon>
            Lista de Personal
          </mat-list-item>
          <mat-divider></mat-divider>
          <mat-list-item routerLink="lista-maquinaria-equipo/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">local_shipping</mat-icon>
            Lista de Maquinaria y Equipo
          </mat-list-item>
          <mat-divider></mat-divider>
          <!-- <mat-list-item routerLink="materiales-concepto/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">beenhere</mat-icon>
            Materiales por Concepto
          </mat-list-item> -->
          <!-- <mat-list-item routerLink="cronograma/{{obra.idObra}}" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">assignment</mat-icon>
            Bitácora de Obra
          </mat-list-item> -->
          <mat-divider></mat-divider>
          <mat-list-item routerLink="../../obras/registro" routerLinkActive="list-item-active">
            <mat-icon class="mr-1">arrow_back</mat-icon>
            Regresar Obras
          </mat-list-item>
        </mat-nav-list>
      </div>
    </mat-card>
  </div>

  <!-- Profile Views -->
  <div fxFlex="100" fxFlex.gt-sm="100" fxFlex.gt-md="100">
    <router-outlet></router-outlet>
  </div>

  <!-- <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" *ngIf= "obra.idSupervisor !== usuarioLogeado && usuario.idPerfil !== 1">
    <mat-card>
      <mat-card-content class="wrap-spiner">
        <div class="wrap-message">
          <div class="icon">
            <mat-icon>lock</mat-icon>
          </div>
          <div class="message">
            <h1>ACCESSO DENEGADO</h1>
            <p>Usuario no puede visualizar la información de esta obra</p>
          </div>
        </div>
      </mat-card-content>
      <mat-card-actions class="direction">
          <button mat-button color="primary" [routerLink]="['/dashboard']">Inicio</button>
      </mat-card-actions>
    </mat-card>
  </div> -->

</div>